(this["webpackJsonpredux-exercise"]=this["webpackJsonpredux-exercise"]||[]).push([[0],{65:function(e,t,a){e.exports=a(98)},70:function(e,t,a){},72:function(e,t,a){},82:function(e,t,a){},83:function(e,t,a){},84:function(e,t,a){},85:function(e,t,a){},86:function(e,t,a){},87:function(e,t,a){},91:function(e,t,a){},92:function(e,t,a){},93:function(e,t,a){},94:function(e,t,a){},97:function(e,t,a){},98:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(23),o=a.n(c),u=(a(70),a(4)),s=a.n(u),l=a(12),i=(a(72),a(9)),m=a(7),p=a(34),f=a.n(p);a(77),a(80);f.a.initializeApp({apiKey:"AIzaSyCIWtOYcNVbkFSc5zeTl1OD5ipu2NPmwiM",authDomain:"chat-app-8976e.firebaseapp.com",databaseURL:"https://chat-app-8976e.firebaseio.com",projectId:"chat-app-8976e",storageBucket:"chat-app-8976e.appspot.com",messagingSenderId:"622522794289",appId:"1:622522794289:web:a089a4b8f033367ac67010",measurementId:"G-Y5ZTFZ215Q"});var d=f.a.auth(),h=f.a.firestore(),b=new f.a.auth.GoogleAuthProvider;b.setCustomParameters({prompt:"select_account"});var E=function(){var e=Object(l.a)(s.a.mark((function e(t,a){var n,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=h.doc("users/".concat(t.uid)),e.next=5,n.get();case 5:if(e.sent.exists){e.next=17;break}return r=t.email,c=new Date,e.prev=9,e.next=12,n.set({email:r,createdAt:c,userName:a});case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(9),console.log("error creating user",e.t0.message);case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}}),e,null,[[9,14]])})));return function(t,a){return e.apply(this,arguments)}}(),v=function(e,t,a){return function(){var n=Object(l.a)(s.a.mark((function n(r,c){var o,u;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,d.createUserWithEmailAndPassword(t,a);case 3:return o=n.sent,u=o.user,n.next=7,E(u,e);case 7:n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),console.log(n.t0);case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e,t){return n.apply(this,arguments)}}()},g=function(){return function(){var e=Object(l.a)(s.a.mark((function e(t,a){var n,r,c,o,u,l,i,m,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.signInWithPopup(b);case 3:if(n=e.sent,r=n.user,c=r.uid,o=r.displayName,u=r.email,r){e.next=8;break}return e.abrupt("return");case 8:return l=h.doc("users/".concat(c)),e.next=11,l.get();case 11:if((i=e.sent).exists){e.next=17;break}return m=new Date,p=o,e.next=17,l.set({email:u,createdAt:m,userName:p});case 17:return e.abrupt("return",i);case 20:e.prev=20,e.t0=e.catch(0),console.log(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t,a){return e.apply(this,arguments)}}()},x="USER_LOGIN_SIGNUP",O="USER_LOGOUT",N="USER_INITIALIZE",j="USERNAME_CHANGE",y=function(e){return{type:x,payload:e}},w=a(15),k=a(38),C=Object(k.a)([function(e){return e.user}],(function(e){return e.userInfo})),I=(a(82),function(e){var t=Object(n.useState)(""),a=Object(w.a)(t,2),c=a[0],o=a[1],u=Object(n.useState)(!1),s=Object(w.a)(u,2),l=s[0],i=s[1],p=Object(m.c)((function(e){return e})),f=C(p);return Object(n.useEffect)((function(){var e=d.onAuthStateChanged((function(e){e?(o(f.userName),i(!0)):(o(f.userName),i(!1))}));return function(){e()}})),r.a.createElement("div",{className:"homePageDiv"},r.a.createElement("div",{className:"homePageBody"},l?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"hiName"},"Hi, ",c," !"),r.a.createElement("h2",null,"Choose the Topic"),r.a.createElement("p",null,"You want to talk about")):r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Choose the Topic"),r.a.createElement("p",null,"You want to talk about")),r.a.createElement("ul",null,r.a.createElement("li",{onClick:function(){return e.history.push("/redux-exercise/chat/greeting")},className:"topicGreeting"},r.a.createElement("span",null,"Greeting")),r.a.createElement("li",{onClick:function(){return e.history.push("/redux-exercise/chat/food")},className:"topicFood"},r.a.createElement("span",null,"Food")),r.a.createElement("li",{onClick:function(){return e.history.push("/redux-exercise/chat/movie")},className:"topicMovie"},r.a.createElement("span",null,"Movie")),r.a.createElement("li",{onClick:function(){return e.history.push("/redux-exercise/chat/programming")},className:"topicProgramming"},r.a.createElement("span",null,"Programming")),r.a.createElement("li",{onClick:function(){return e.history.push("/redux-exercise/chat/outdoor")},className:"topicOutdoor"},r.a.createElement("span",null,"Outdoor Activity")),r.a.createElement("li",{onClick:function(){return e.history.push("/redux-exercise/chat/traveling")},className:"topicTraveling"},r.a.createElement("span",null,"Traveling")),r.a.createElement("li",{onClick:function(){return e.history.push("/redux-exercise/chat/school")},className:"topicSchool"},r.a.createElement("span",null,"School")))))}),S=(a(83),a(6)),P="COMMENTLIST_SETUP",A="ADD_NEWCOMMENT",D=function(e){return{type:P,payload:e}},L=function(e){return{type:A,payload:e}},T=Object(k.a)([function(e){return e.comments}],(function(e){return e.commentList})),M=function(e){var t=e.comment;return r.a.createElement("li",null,r.a.createElement("p",{className:"commentData"},r.a.createElement("span",{className:"commentNo"},"No.",t.commentNo),r.a.createElement("span",{className:"commentName"},t.userName),r.a.createElement("span",{className:"commentDate"},t.date),r.a.createElement("span",{className:"commentTime"},t.time)),r.a.createElement("div",{className:"commentMessage"},r.a.createElement("p",null,t.message)))},G=(a(84),function(e){var t=e.topic,a=t+"BackGround",c=Object(m.b)(),o=Object(m.c)((function(e){return e})),u=T(o);return Object(n.useEffect)((function(){var e;c((e="chat-"+t,function(){var t=Object(l.a)(s.a.mark((function t(a,n){var r,c;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=h.collection(e),c=[],t.next=4,r.orderBy("commentNo").get().then((function(e){e.forEach((function(e){var t=e.data();t=Object(S.a)(Object(S.a)({},t),{},{id:e.id}),c.push(t)}))}));case 4:a(D(c));case 5:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())),c(function(e){return function(){var t=Object(l.a)(s.a.mark((function t(a,n){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=h.collection(e),t.next=3,r.orderBy("commentNo").onSnapshot((function(e){e.docChanges().forEach((function(e){if("added"==e.type){var t=e.doc.data();console.log(t),a(L(t))}else e.type}))}));case 3:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()}("chat-"+t))}),[]),Object(n.useEffect)((function(){var e=document.querySelector(".commentListWrapper");e.scrollTop=e.scrollHeight,console.log(u)}),[u]),r.a.createElement("div",{className:"commentListWrapper "+a},r.a.createElement("ul",{className:"commentList"},u.map((function(e){return r.a.createElement(M,{key:e.commentNo,comment:e})}))))}),B=a(119),W=a(117),U=a(120),F=Object(W.a)((function(e){return{button:{margin:e.spacing(1)}}}));function q(e){var t=F();return r.a.createElement(B.a,{variant:"contained",color:"primary",style:{background:"#100c08"},className:t.button,endIcon:null!==e.icon?r.a.createElement(U.a,null,e.icon):null,onClick:e.click},e.text)}a(85);var R=function(e){var t=Object(m.b)(),a=Object(m.c)((function(e){return e.comments})),c=Object(m.c)((function(e){return e.user.userInfo})),o=a.commentList.length+1,u=e.topic;o<10?o="000"+o:o<100?o="00"+o:o<1e3&&(o="0"+o);var i=Object(n.useState)("Visitor"),p=Object(w.a)(i,2),f=p[0],b=p[1],E=Object(n.useState)(""),v=Object(w.a)(E,2),g=v[0],x=v[1],O=Object(n.useState)(o),N=Object(w.a)(O,2),y=N[0],k=N[1],C=Object(n.useState)(!1),I=Object(w.a)(C,2),P=I[0],A=I[1];return Object(n.useEffect)((function(){k(o)}),[a]),Object(n.useEffect)((function(){var e=d.onAuthStateChanged((function(e){e?(b(c.userName),A(!0),console.log("run 1")):(b(c.userName),A(!1),console.log("run 2"))}));return function(){e()}})),r.a.createElement("div",{className:"inputAreaDiv"},r.a.createElement("form",null,P?r.a.createElement("input",{className:"loginedUserNameInput",readOnly:"readonly",type:"text",value:f}):r.a.createElement("input",{type:"text",placeholder:"Your Name",onChange:function(e){t(function(e){return{type:j,payload:e}}(e.target.value)),b(e.target.value)},value:f}),r.a.createElement("textarea",{placeholder:"Write message",onChange:function(e){x(e.target.value)},value:g,required:!0}),r.a.createElement(q,{text:"send",icon:"send",type:"submit",click:function(e){e.preventDefault();var a=g,n=f;""===a&&(a="No Message"),""===n&&(n="No Name");var r,o,i,m=(new Date).getMonth()+1+"/"+(new Date).getDate()+"/"+(new Date).getFullYear(),p=(new Date).getHours(),d=(new Date).getMinutes()<10?"0"+(new Date).getMinutes():(new Date).getMinutes();t((r="chat-"+u,o={commentNo:y,date:m,time:p+":"+d,userName:n,message:a},i=c.authId,function(){var e=Object(l.a)(s.a.mark((function e(t,a){var n,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.collection(r),c=o,null!==i&&(c=Object(S.a)(Object(S.a)({},o),{},{userId:i})),e.next=5,n.add(c);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())),x("")}})))},Y=function(e){var t=e.match.params.topic;return r.a.createElement("div",{className:"Chat"},r.a.createElement("div",{className:"pageStyle"},r.a.createElement(G,{topic:t}),r.a.createElement(R,{topic:t})))},_=a(28),z=a(57),H=(a(86),function(e){var t=e.handleChange,a=e.label,n=Object(z.a)(e,["handleChange","label"]);return r.a.createElement("div",{className:"group"},r.a.createElement("input",Object.assign({className:"form-input",onChange:t},n)),a?r.a.createElement("label",{className:"".concat(n.value.length?"shrink":""," form-input-label")},a):null)}),V=(a(87),function(){var e=Object(n.useState)({email:"",password:""}),t=Object(w.a)(e,2),a=t[0],c=t[1],o=Object(m.b)(),u=Object(i.f)(),p=a.email,f=a.password,h=function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),p&&f){e.next=4;break}return alert("Please fill in all fields"),e.abrupt("return");case 4:return e.prev=4,e.next=7,d.signInWithEmailAndPassword(p,f);case 7:return c({email:"",password:""}),e.next=10,d.onAuthStateChanged(function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,E(t);case 3:e.sent.onSnapshot((function(e){o(y({userName:e.data().userName,authId:e.id,isLogin:!0}))}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:u.push("/redux-exercise/"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}(),b=function(e){var t=e.target,n=t.value,r=t.name;c(Object(S.a)(Object(S.a)({},a),{},Object(_.a)({},r,n)))};return r.a.createElement("div",{className:"loginInputArea"},r.a.createElement("form",null,r.a.createElement(H,{name:"email",type:"email",value:p,handleChange:b,label:"Email",required:!0}),r.a.createElement(H,{name:"password",type:"password",value:f,handleChange:b,label:"Password",required:!0}),r.a.createElement("div",{className:"buttons"},r.a.createElement(q,{click:h,text:"Login",icon:null}))))}),Z=a(20),J=a(27),K=(a(91),function(){var e=Object(i.f)(),t=Object(m.b)(),a=function(){var a=Object(l.a)(s.a.mark((function a(){return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t(g());case 2:if(!a.sent){a.next=7;break}setTimeout((function(){e.push("/redux-exercise/")}),500),a.next=8;break;case 7:return a.abrupt("return");case 8:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();return r.a.createElement("div",{className:"loginPageDiv"},r.a.createElement("div",{className:"loginPageBody"},r.a.createElement("h2",null,"Login"),r.a.createElement("p",null,"Login with your Email Address or",r.a.createElement("br",null),r.a.createElement("span",{className:"googleAccount",onClick:a},"Google Account"),"\xa0",r.a.createElement(Z.a,{icon:J.a})),r.a.createElement("p",null,"If you don't have your account yet,",r.a.createElement("br",null),r.a.createElement("span",{className:"pleaseSignup",onClick:function(){return e.push("/redux-exercise/signup")}},"please Signup"),"\xa0",r.a.createElement(Z.a,{icon:J.a})),r.a.createElement(V,null)))}),Q=(a(92),function(){var e=Object(n.useState)({userName:"",email:"",password:"",confirmPass:""}),t=Object(w.a)(e,2),a=t[0],c=t[1],o=Object(m.b)(),u=Object(i.f)(),p=a.userName,f=a.email,d=a.password,h=a.confirmPass,b=function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),p&&f&&d&&h){e.next=4;break}return alert("Please fill in all fields"),e.abrupt("return");case 4:if(!(d.length<6)){e.next=7;break}return alert("Password should be 6 or more characters"),e.abrupt("return");case 7:if(d===h){e.next=10;break}return alert("Passwords don't match"),e.abrupt("return");case 10:return e.prev=10,e.next=13,o(v(p,f,d));case 13:c({userName:"",email:"",password:"",confirmPass:""}),u.push("/redux-exercise/"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(10),console.log(e.t0);case 20:case"end":return e.stop()}}),e,null,[[10,17]])})));return function(t){return e.apply(this,arguments)}}(),E=function(e){var t=e.target,n=t.value,r=t.name;c(Object(S.a)(Object(S.a)({},a),{},Object(_.a)({},r,n)))};return Object(n.useEffect)((function(){console.log(a)})),r.a.createElement("div",{className:"loginInputArea"},r.a.createElement("form",null,r.a.createElement(H,{name:"userName",type:"text",value:p,handleChange:E,label:"Name",required:!0}),r.a.createElement(H,{name:"email",type:"email",value:f,handleChange:E,label:"Email",required:!0}),r.a.createElement(H,{name:"password",type:"password",value:d,handleChange:E,label:"Password",required:!0}),r.a.createElement(H,{name:"confirmPass",type:"password",value:h,handleChange:E,label:"Confirm Password",required:!0}),r.a.createElement("div",{className:"buttons"},r.a.createElement(q,{text:"Signup",icon:null,click:b}))))}),$=(a(93),function(){var e=Object(i.f)(),t=Object(m.b)(),a=function(){var a=Object(l.a)(s.a.mark((function a(){return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t(g());case 2:if(!a.sent){a.next=7;break}setTimeout((function(){e.push("/redux-exercise/")}),500),a.next=8;break;case 7:return a.abrupt("return");case 8:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();return r.a.createElement("div",{className:"signupPageDiv"},r.a.createElement("div",{className:"signupPageBody"},r.a.createElement("h2",null,"Signup"),r.a.createElement("p",null,"Signup with your Email Address or",r.a.createElement("br",null),r.a.createElement("span",{className:"googleAccount",onClick:a},"Google Account"),"\xa0",r.a.createElement(Z.a,{icon:J.a})),r.a.createElement(Q,null)))}),X=a(124),ee=a(121),te=a(123),ae=a(122),ne=a(47),re=a.n(ne),ce=(a(94),Object(W.a)((function(e){return{root:{flexGrow:1,position:"fixed",width:"100%",zIndex:100},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,fontFamily:"'Dancing Script', cursive",fontWeight:600,fontSize:"2rem"}}})));function oe(){var e=Object(n.useState)("Chat Place"),t=Object(w.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(!1),u=Object(w.a)(o,2),s=u[0],l=u[1],m=ce();d.onAuthStateChanged((function(e){l(!!e)}));var p=Object(i.f)();return Object(n.useEffect)((function(){return p.listen((function(e){var t=e.pathname;t="/redux-exercise"===t||"/redux-exercise/"===t||"/"===t||""===t?"Chat Place":t.slice(t.lastIndexOf("/")+1),c(t)}))})),r.a.createElement("div",{className:m.root},r.a.createElement(X.a,{position:"static",style:{background:"#100c08"}},r.a.createElement(ee.a,null,"Chat Place"!==a?r.a.createElement(ae.a,{edge:"start",className:m.menuButton,color:"inherit","aria-label":"menu",onClick:function(){return p.push("/redux-exercise/")}},r.a.createElement(re.a,null)):r.a.createElement(ae.a,{edge:"start",className:m.menuButton,style:{color:"#100c08",cursor:"inherit"},"aria-label":"menu"},r.a.createElement(re.a,null)),r.a.createElement(te.a,{variant:"h6",className:m.title},a),s?r.a.createElement(B.a,{color:"inherit",onClick:function(){d.signOut()}},"Logout"):r.a.createElement(B.a,{color:"inherit",onClick:function(){return p.push("/redux-exercise/login")}},"Login"))))}var ue=a(48),se=(a(97),function(){return r.a.createElement("footer",{className:"pageFooter"},r.a.createElement("div",{className:"nameAndCopyDiv"},r.a.createElement("p",{className:"footerCopyright"},"\xa9 2020 Tomohiro Yoshida. All Rights Reserved")),r.a.createElement("ul",{className:"contactList"},r.a.createElement("li",{className:"linkedinItem"},r.a.createElement("a",{href:"https://www.linkedin.com/in/tomohiro-yoshida-a8320816a/"},r.a.createElement(Z.a,{icon:ue.b}))),r.a.createElement("li",{className:"githubItem"},r.a.createElement("a",{href:"https://github.com/TOMO-YOSHI"},r.a.createElement(Z.a,{icon:ue.a}))),r.a.createElement("li",{className:"mailItem"},r.a.createElement("a",{href:"mailto: tyoshida01@mylangara.ca"},r.a.createElement(Z.a,{icon:J.b})))))});var le=function(){var e=Object(m.b)(),t=Object(m.c)((function(e){return e}));return Object(n.useEffect)((function(){var t=d.onAuthStateChanged(function(){var t=Object(l.a)(s.a.mark((function t(a){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=7;break}return t.next=3,E(a);case 3:n=t.sent,setTimeout((function(){n.get().then(function(){var t=Object(l.a)(s.a.mark((function t(a){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(a.data()),t.next=3,a.data().userName;case 3:r=t.sent,e(y({userName:r,authId:n.id,isLogin:!0}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),500),t.next=8;break;case 7:e({type:N});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());return function(){t()}}),[y]),Object(n.useEffect)((function(){console.log(t.user.userInfo)})),r.a.createElement("div",{className:"App"},r.a.createElement(oe,null),r.a.createElement(i.c,null,r.a.createElement(i.a,{exact:!0,path:"/redux-exercise",component:I}),r.a.createElement(i.a,{path:"/redux-exercise/chat/:topic",component:Y}),r.a.createElement(i.a,{path:"/redux-exercise/login",component:K}),r.a.createElement(i.a,{path:"/redux-exercise/signup",component:$})),r.a.createElement(se,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ie=a(22),me=a(25),pe=a(56),fe={commentList:[]},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case P:return Object(S.a)(Object(S.a)({},e),{},{commentList:t.payload});case A:return Object(S.a)(Object(S.a)({},e),{},{commentList:[].concat(Object(pe.a)(e.commentList),[t.payload])});default:return e}},he={userInfo:{userName:"Visitor",authId:null,isLogin:!1}},be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return Object(S.a)(Object(S.a)({},e),{},{userInfo:t.payload});case j:return Object(S.a)(Object(S.a)({},e),{},{userInfo:Object(S.a)(Object(S.a)({},e.userInfo),{},{userName:t.payload})});case O:return he;default:return e}},Ee=Object(me.c)({comments:de,user:be}),ve=[a(55).a],ge=Object(me.d)(Ee,me.a.apply(void 0,ve));o.a.render(r.a.createElement(m.a,{store:ge},r.a.createElement(ie.a,null,r.a.createElement(le,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[65,1,2]]]);
//# sourceMappingURL=main.516ef61b.chunk.js.map